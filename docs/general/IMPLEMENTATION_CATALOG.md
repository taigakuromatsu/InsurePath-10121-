# 社会保険（健康保険・介護保険・厚生年金）管理システム　カタログ

**システム名：InsurePath（インシュアパス）**

**作成者：黒松大河**

---

## 目的

本システムは、社会保険管理システムとして、月額保険料および賞与にかかる社会保険料を計算・管理し、各事業所（会社）ごとに分離されたデータ領域の中で、従業員ごとの健康保険・介護保険・厚生年金保険の標準報酬月額・等級・保険料・会社負担分を一元管理し、「本人負担額」と「会社負担額」を分けて確認できるようにすることを目的とする。計算方法は協会けんぽや年金機構の説明に沿って設計されている。

あわせて、被保険者本人およびその被扶養者の社会保険資格情報（資格取得日・資格喪失日・続柄・生年月日・就労条件等）を一元管理し、「誰がいつからいつまでどの社会保険の適用を受けているか」を追跡できるようにすることで、会社が行う社会保険の各種手続き・確認業務を支援する。

人事・総務担当者は、自社事業所に所属する従業員について、事業所全体の社会保険料負担や従業員別の内訳を把握できる。

従業員本人は、自分の社会保険料がいくら控除され、会社がいくら負担しているかを Web 画面上で直感的に確認できる。

また、社会保険情報が機密性の高い個人情報であることを踏まえ、認証・ロール別アクセス制御・事業所単位のデータ分離により、安全性と機密性の高い管理を行うことを重視する。

---

## 実装機能


### (1) 事業所（会社）管理機能 ✅

- 事業所（会社）の基本情報を登録・編集できる。
  - 事業所名、所在地、郵便番号、電話番号
  - 事業所整理記号、事業所番号、事業主（代表者）氏名
- 健康保険の種別として「協会けんぽ」「健康保険組合」のいずれかを選択できる。
  - **協会けんぽを選択した場合**：
    - 加入している都道府県を選択する（都道府県コードは自動設定される）
    - 保険料率と等級表は、クラウドマスタから該当都道府県のプリセットを読み込める（(26) 保険料率・等級表クラウドマスタ・自動更新機能参照）
  - **健康保険組合を選択した場合**：
    - 加入している健康保険組合名と組合コード（任意）を登録する
    - 保険料率と等級表は、マスタ管理画面で手動で設定する必要がある
- 各事業所ごとに、従業員台帳・等級マスタ・保険料率マスタ・保険料計算結果などのデータを保持し、他の事業所と分離して管理する。
- 事業所の作成は、初回ログイン時に「新規事業所を作成」画面から行う。既存の事業所に参加する場合は、管理者から送られた招待リンクを利用する。
- **初回セットアップ案内（オンボーディング機能）**：
  - 事業所作成後、初回ログイン時にオンボーディングダイアログが自動表示される
  - セットアップ手順（事業所設定→保険料率管理→従業員台帳→月次保険料・賞与保険料）を案内し、ユーザーがスムーズに初期設定を進められるようにする
  - オンボーディングを一度確認したユーザーには、次回以降は表示されない（`hasSeenOnboarding`フラグで管理）


### (2) ユーザー・ロール管理機能 ✅

- Firebase Authentication によりユーザーごとのログイン認証を行う。未ログイン状態では、いかなるデータにもアクセスできない。
- 各ユーザーは必ず1つの事業所に所属し、ユーザーデータに「所属事業所 ID」と「ロール（admin / hr / employee）」を保持する。
- ユーザープロファイルには、表示名、メールアドレス、ロール、所属事業所ID、従業員ID（従業員として登録されている場合）を保持する。
- **ロールに応じて利用できる画面・機能を制御する**：
  - **管理者（admin）**：事業所設定・ユーザー管理（ロール変更）・保険料率マスタ・従業員台帳・保険料一覧・ダッシュボード・手続き管理・書類管理・納付状況管理などの全機能の閲覧・編集が可能
  - **人事・総務担当者（hr）**：従業員台帳・保険料計算・月次一覧・賞与管理・ダッシュボード・手続き管理・書類管理・納付状況管理などの閲覧および実務に必要な一部編集が可能。事業所設定・ユーザー管理・マスタ編集は不可。
  - **一般従業員（employee）**：マイページのみアクセス可能。自分の情報の閲覧、変更申請（プロフィール変更・口座情報変更・扶養家族の追加・変更・削除）、書類アップロード依頼への対応のみ利用可能。他者情報や設定画面にはアクセス不可。
- 従業員の給与額（報酬月額）、入社日、退職日、保険等級、社会保険加入フラグの編集は admin / hr のみに許可し、従業員本人は閲覧のみとする。
- **ユーザー管理機能**：
  - 管理者は、事業所設定画面の「ユーザー管理」タブから、同一事業所に属するユーザーの一覧を確認できる
  - ユーザーのロール（admin / hr / employee）を変更できる
  - 各ユーザーの従業員IDの紐付け状況を確認できる
- **従業員ポータル招待機能**：
  - 管理者・人事担当者は、従業員にポータル招待を発行できる
  - 招待URLを生成し、従業員に共有することで、従業員が自分のアカウントを作成してマイページにアクセスできるようになる
  - 招待URLは7日間有効
  - 従業員は招待リンクを開くと、ログインページ（従業員モード）に遷移し、Googleアカウントでログインする
  - ログイン後、招待リンクのトークンを検証し、メールアドレスの一致確認、有効期限チェック、既使用チェックを行い、アカウントを従業員レコードに紐づける
  - 招待リンクは1回のみ使用可能で、使用済みの場合は再招待が必要


### (3) 従業員台帳・在籍・資格情報・就労条件管理機能 ✅

- 従業員の基本情報（氏名、フリガナ、生年月日、住所、電話番号、メールアドレス、入社日、退職日、所属部署、郵便番号、住所カナ、性別、社員番号など）を登録・閲覧できる。
- 従業員ごとに、以下の情報を保持する。
  - 雇用区分（正社員・契約社員・パート・アルバイト等）
  - 社員番号
  - 報酬月額（月給）、支給形態（月給・日給・時給・年俸等）、支給サイクル（月次・月2回・週次等）
  - 介護保険の対象判定に必要な生年月日（40〜64歳の判定に利用）
  - 所定労働時間（週あたりの時間数）
  - 所定労働日数（週または月あたりの日数）
  - 雇用契約期間の見込み（○か月以上などの簡易項目）
  - 学生フラグ（学生であるかどうか）
  - 健康保険の被保険者記号・番号
  - 厚生年金の被保険者番号（基礎年金番号）
  - マイナンバー（個人番号、暗号化保存、マスキング表示）
  - 給与振込口座情報（金融機関名・支店名・口座種別・口座番号・名義等）
- 短時間労働者の社会保険適用判定に関して、システムは上記の就労条件情報を保持し、判定の参考情報として提示するが、最終的な適用判断は事業所側の責任。
- 従業員ごとに社会保険加入フラグ（isInsured）を持ち、このフラグがONの従業員のみを、社会保険料計算・月次一覧・従業員別明細・賞与計算の対象とする。
- 健康保険・厚生年金それぞれについて、以下のような資格情報を保持し管理する。
  - 資格取得日
  - 資格喪失日
  - 資格取得区分（新規採用／適用拡大による加入／所定労働時間の変更による加入 等の簡易区分）
  - 資格喪失理由区分（退職／死亡／75歳到達／障害認定／社会保障協定 等の簡易区分）
- 入社日・退職日・対象年月および資格取得日・資格喪失日に基づき、その月に社会保険料を計上するかどうかを自動判定する（入社前の月・退職後の月は対象外とし、退職月・資格喪失月の詳細な例外ケースは簡略化したルールに従う）。
- 従業員の年齢から、介護保険の第 2 号被保険者（40〜64 歳）に該当するかを判定し、介護保険料の有無を自動で切り替える。
- 従業員ごとに、就業状態を示すステータスを管理する。
  - ステータス：通常勤務／産前産後休業／育児休業
  - 保険料免除月（産前産後休業・育児休業）を年月単位で指定でき、該当月の保険料は計算対象外となる。
  - 注：各ステータスの開始日・終了日の詳細な期間管理は未実装（将来拡張として検討中）。現時点ではステータスと免除月の指定のみ。
- 退職後の任意継続被保険者は本システムの管理対象外とし、在籍中の被保険者のみを対象とする。


### (4) 被扶養者（家族）管理機能 ✅

- 従業員ごとに、健康保険の被扶養者（配偶者・子・父母 等）の情報を登録・編集できる。
- 被扶養者ごとに、以下の情報を保持する。
  - 氏名・フリガナ
  - 続柄（配偶者・子・父母・祖父母・兄弟姉妹・孫・その他）
  - 生年月日
  - 性別
  - 被扶養者資格取得日
  - 被扶養者資格喪失日
  - 郵便番号・住所
  - 同居／別居フラグ（同居・別居）
  - 就労状況（就労しているかどうか）
  - マイナンバー（個人番号、暗号化保存、マスキング表示）
- 資格取得日・喪失日に基づき、特定の年月時点でどの被扶養者が扶養に入っていたかを確認できる。
- 従業員別・事業所別に、現在扶養に入っている家族の一覧を表示できる。
- 被扶養者情報の追加・削除・変更について、最終更新者・最終更新日時を記録し、扶養に関する手続きの経緯を追跡できるようにする。
- 被扶養者資格の細かな判定ロジック（所得要件や同居要件など）は簡略化し、最終的な扶養認定は事業所と健康保険組合等の判断に委ねる。
- 注：学生区分・障害区分などの資格判定に必要な基本属性の詳細な管理は未実装（将来拡張として検討中）。現時点では就労状況のみを管理。


### (5) 標準報酬決定・改定履歴管理機能 ✅

- 従業員ごとに、標準報酬月額・等級の決定・改定の履歴を管理する。
- **健康保険・厚生年金を分けて管理**：健康保険用と厚生年金用の標準報酬履歴を別々に管理し、それぞれ独立して登録・編集できる。
- 履歴ごとに、以下の情報を保持する。
  - 保険種別（健康保険・厚生年金）
  - 適用開始年月
  - 標準報酬月額（マスタデータから選択可能な値のみ）
  - 等級（標準報酬月額を選択すると自動設定）
  - 決定区分（通常決定／随時改定／賞与支払時決定／資格取得時決定／資格喪失時決定／その他）
  - 備考（昇給・降給・時短変更などのメモ）
- 報酬月額から標準報酬月額・等級を自動入力する機能を提供する。報酬月額を入力すると、保険種別に応じたマスタデータの等級表から該当する標準報酬月額と等級を自動判定して入力する。
- 標準報酬月額の選択肢は、適用開始年月に応じたマスタデータ（健康保険マスタまたは厚生年金マスタ）の等級表から取得される。
- 現在有効な標準報酬だけでなく、過去の決定・改定の履歴を一覧で確認できるようにし、「いつ・どの区分で・どの標準報酬が適用されていたか」を追跡できるようにする。
- 社会保険料自動計算機能は、対象年月に対してこの履歴情報から適用すべき標準報酬を自動判定して利用する。適用開始年月が対象年月以前の履歴のうち、最新のものを適用する。


### (6) 標準報酬月額・等級・保険プランマスタ管理機能 ✅

- 健康保険・介護保険・厚生年金について、等級ごとの標準報酬月額を事業所単位のマスタとして登録・編集できる。保険料率はマスタで事業所ごとに一律管理。
- 標準報酬月額・等級の考え方（共通方針）
  - 健康保険組合（組合健保）・全国健康保険協会（協会けんぽ）ともに、被保険者の毎月の給与額（報酬月額）をいくつかの金額帯に区分し、その帯ごとに「等級」と「標準報酬月額」を決定する。
  - 等級表は「等級」「下限報酬月額」「上限報酬月額（上限なし可）」「標準報酬月額」の組み合わせで管理される。
- 健康保険（医療分）マスタ
  - 協会けんぽ：事業所の所在地都道府県ごとの健康保険料率と等級表を「適用開始年月別マスタ」として保持する。クラウドマスタから2023年3月改定分・2024年3月改定分・2025年3月改定分のプリセットを読み込める。将来改定された場合は、管理者がマスタ画面から新しい適用開始年月の料率・等級表を登録・更新できる。
  - 組合健保：事業所が加入する健康保険組合ごとの健康保険料率と等級表を、管理者がマスタ画面から設定・更新できる。
- 介護保険マスタ
  - 協会けんぽ：40〜64 歳の第2号被保険者向け介護保険料率（全国一律）を「適用開始年月別マスタ」として保持する。クラウドマスタから2023年3月改定分・2024年3月改定分・2025年3月改定分のプリセットを読み込める。
  - 組合健保：各健康保険組合ごとの介護保険料率を、事業所ごとのマスタとして管理者が設定・更新できる。
- 厚生年金マスタ
  - 厚生年金保険料率（事業主＋従業員合計の率）は全国共通であり、協会けんぽ／組合健保の別に関係なく単一の全国マスタとして「適用開始年月別」に保持する。クラウドマスタから2017年9月改定分のプリセットを読み込める。
  - 将来料率が改定された場合は、管理者がマスタ画面から新しい適用開始年月の料率・等級表を登録・更新できる。
- 保険料率および標準報酬月額には「適用開始年月（年・月）」を持たせ、年度ごとの改定にマスタ更新で対応できる設計とする。
- 協会けんぽ・厚生年金ともに、外部サイトからの自動取得は行わず、管理者がマスタ画面で料率・等級表を変更する運用とする。


### (7) 社会保険料自動計算機能（健康保険・介護保険・厚生年金） ✅

- 従業員の標準報酬月額（等級）と保険料率マスタから、以下の計算ロジックに基づき、各保険の保険料総額・本人負担額・会社負担額を自動計算する。

#### １．厚生年金保険料

- 厚生年金保険料総額 = 標準報酬月額（厚年等級） × 厚生年金保険料率（事業主＋従業員合計）
- 従業員負担分 = 厚生年金保険料総額 ÷ 2（50銭ルール適用）
- 会社負担分 = 厚生年金保険料総額（全従業員分・端数切捨て） − 全従業員負担分

#### ２．介護保険料（40〜64 歳のみ）

- 年齢（生年月日）から 40〜64 歳のみ介護保険料計算の対象とする。
- 介護保険料総額 = 標準報酬月額 × 介護保険料率（協会けんぽの場合は全国一律のマスタ値、組合健保の場合は事業所ごとに設定された率）
- 従業員負担分 = 介護保険料総額 ÷ 2（50銭ルール適用）
- 会社負担分 = 介護保険料総額 − 従業員負担分

#### ３．健康保険料

- 事業所ごとの健康保険プラン（協会けんぽ／組合健保）に応じた健康保険料率を使用する。
- 健康保険料総額 = 標準報酬月額 × 健康保険料率
- 従業員負担分 = 健康保険料総額 ÷ 2（50銭ルール適用）
- 会社負担分 = 健康保険料総額（全従業員分・端数切捨て） − 全従業員負担分

- **端数処理（50銭ルール）**：従業員負担額については、50銭以下は切り捨て、50銭超は切り上げて1円とする。月次一覧・従業員別明細・賞与計算すべてで同一ルールを適用する。
- **納入告知額の端数処理**：健康保険・介護保険の合計額と厚生年金の合計額について、端数処理前の金額を保持し、納入告知額の計算時に端数処理（四捨五入→切り捨て）を適用する。
- 計算結果は対象年月ごと・従業員ごとに保持し、後から参照・比較できるようにする。
- 従業員ごとに「本人負担額」「会社負担額」「合計額」を必ず保持し、個人明細画面でも会社負担分を明示的に確認できるようにする。
- 対象年月に保険資格がない従業員（資格取得日が対象年月より後、または資格喪失日が対象年月より前）は、その保険種別の保険料は計算対象外（0円）となる。
- 産前産後休業・育児休業の免除月が設定されている従業員については、該当月の保険料は計算対象外となる。


### (8) 月次保険料一覧・会社負担集計機能（シート式一覧表示・自動計算） ✅

- 対象年月を指定すると、その事業所に所属する isInsured = true の従業員の社会保険料（月額分）を表計算シートのような一覧画面で表示する。
- 一覧には、以下のような情報を列として表示する。
  - 氏名・年齢・雇用区分・報酬月額
  - 健保等級／標準報酬月額（健保）、厚年等級／標準報酬月額（厚年）
  - 健康保険・介護保険：本人負担・会社負担・合計（介護保険分は40〜64歳のみ表示）
  - 厚生年金：本人負担・会社負担・合計
  - 合計本人負担額・合計会社負担額
- 列のソートやフィルタリングに対応し、多数の従業員でも Excel／スプレッドシートのように見やすく集計できる。
- 事業所全体の会社負担額総計（健康・介護・厚生年金の合計）を自動集計して表示する。サマリーには、健康保険・介護保険の納入告知額（端数処理前・端数処理後）、従業員負担計、会社負担計、厚生年金の納入告知額（端数処理前・端数処理後）、従業員負担計、会社負担計、総合計を表示する。
- 対象年月を選択すると、従業員情報や料率マスタが変更されている場合は自動的に再計算を実行する。
- 標準報酬履歴が未設定の従業員や、保険資格がない従業員を警告表示し計算外とする。
- 表示される一覧は、ログインユーザーの所属事業所のデータのみを対象とする。


### (9) 従業員別保険料明細（マイページ）機能 ✅

- ログインした一般従業員は、自分が所属する事業所における自分自身の保険料明細のみを閲覧できる。
- 月ごとの健康保険・介護保険・厚生年金の本人負担額・会社負担額・合計額を一覧で確認できる。
- 月次保険料と賞与保険料を分けて表示し、それぞれの本人負担額・会社負担額を確認できる。
- 介護保険料については、40〜64歳の対象者のみ表示される。
- 管理者本人も従業員情報を登録してメールアドレスを連携させればマイページを利用可能。


### (10) 保険料シミュレーション機能 ✅

- 想定月給（報酬月額）を入力すると、等級マスタから該当する等級と標準報酬月額を判定し、健康保険・介護保険・厚生年金それぞれの試算ベースの本人負担額・会社負担額を算出して表示する。
- 人事・総務担当者は、昇給や雇用条件変更時に、社会保険料がどの程度変化するかを事前に確認できる。
- 一般従業員も、自分の所属事業所のマスタに基づいたシミュレーションを利用できる。


### (11) ダッシュボード機能 ✅

- 事業所ごとの社会保険料について、以下のグラフを表示する：
  - **過去12ヶ月の月次保険料推移（会社負担額）**：折れ線グラフで月次保険料の推移を表示。
  - **先月・今月の保険料負担（会社負担額）**：棒グラフで月次保険料と賞与保険料を分けて比較表示。
  - **年度別保険料負担（会社負担額）**：棒グラフで前年度と当年度の月次保険料と賞与保険料を分けて比較表示。
- ダッシュボードには、従業員数（社会保険加入者数）、今月の保険料合計（会社負担額）、今月納付予定の社会保険料、今週提出期限の手続き件数、期限超過の手続き件数、要確認データ件数などの統計情報をカード形式で表示する。
- 最近の納付状況（最大12件）を一覧表示し、各月の納付ステータス（未納／納付済／一部納付／納付不要）を把握できる。
- ダッシュボードに表示される集計は、ログインユーザーの所属事業所のデータのみを集計対象とする。
- 注：健康保険・介護保険・厚生年金の構成比をグラフで表示する機能は未実装（将来拡張として検討中）。


### (12) 賞与管理・賞与保険料計算機能 ✅

- 従業員ごとの賞与支給履歴（支給日・支給額・賞与の性質・メモ）を登録・閲覧できる。
- 賞与については、協会けんぽの定義に従い、「賃金・給料・俸給・手当・賞与など、名称を問わず労働の対価として支払われるもののうち、年 3 回以下支給されるもの（性質による）」を賞与として扱う。
- 賞与支給額（税引前）から 1,000 円未満を切り捨てた額を「標準賞与額」として決定し、以下の上限を考慮する。
  - **健康保険**：同一年度（4 月 1 日〜翌年 3 月 31 日）の標準賞与額累計が 573 万円 を上限とする。上限を超えた分は「上限超過額」として記録され、保険料計算の対象外となる。
  - **厚生年金**：同一月の標準賞与額累計が 150 万円 を上限とする。上限を超えた分は「上限超過額」として記録され、保険料計算の対象外となる。
- 標準賞与額をもとに、健康保険・介護保険・厚生年金の賞与にかかる保険料（本人負担分・会社負担分）を自動計算する。
- 賞与登録時に、標準賞与額と上限チェックの結果をプレビュー表示し、上限超過額がある場合は警告を表示する。
- 賞与支給月の月次保険料一覧および従業員別明細に、賞与にかかる社会保険料を含めた合計負担額を表示する。
- 年度単位で賞与にかかる会社負担総額を集計し、ダッシュボードで確認できる。
- 賞与の性質（通常の季節賞与、業績連動インセンティブ、決算賞与、特別一時金・スポット、その他）を記録できる。


### (13) セキュリティ・アクセス制御機能 ✅

- Firebase Authentication による認証を必須とし、未認証ユーザーはアプリケーションのいかなるデータにもアクセスできない。
- Firestore セキュリティルール等を用いて、ユーザーの「所属事業所 ID」と「ロール（admin / hr / employee）」に基づき、参照・更新可能なドキュメントを制御する。
- **ロール別のアクセス権限**：
  - **admin（管理者）**：事業所内の全データの閲覧・作成・更新・削除が可能。
  - **hr（人事・総務担当者）**：従業員情報、保険料情報、手続き情報、書類情報などの閲覧・作成・更新が可能。一部の設定変更は admin のみが可能。
  - **employee（一般従業員）**：自分の従業員情報、自分の保険料明細、自分の書類、自分宛ての書類アップロード依頼の閲覧・操作が可能。
- 従業員別保険料明細は、当該従業員本人と、権限を持つ管理者・担当者のみが閲覧できるように制限する。
- 事業所間でデータが混在しないようにし、他事業所の従業員情報・保険料情報には一切アクセスできない。
- マイナンバーについては、画面表示時に下4桁のみのマスキング表示（例：`*******1234`）を行う。フル番号の入力・編集は管理者（admin / hr）のみが可能。
- 注：健康保険の被保険者記号・番号や厚生年金の被保険者番号のマスキング表示は未実装（将来拡張として検討中）。


### (14) 従業員情報一括インポート機能 ✅

- 人事・総務担当者が CSV ファイルをアップロードすることで、複数の従業員情報（氏名・生年月日・入社日・部署・雇用区分・報酬月額・社会保険加入フラグ・口座情報・給与情報 等）を一括登録できる。
- 新規作成と更新の両方に対応。ID列を空欄にすると新規作成、既存の従業員IDを入力すると更新となる。
- 読み込み時に基本的な形式チェック（必須項目の確認、日付形式の検証、選択肢の妥当性チェック 等）を行い、エラー行については画面上で確認・修正できるようにする。
- CSVテンプレートのダウンロード機能（(33) CSVテンプレートダウンロード機能）と連携し、入力ルールをコメント行で説明している。
- 大量の従業員を扱う事業所での初期導入・メンテナンス作業の負担を軽減することを目的とする。


### (15) 保険料データの CSV エクスポート機能 ✅

- 月次保険料一覧、従業員台帳、賞与一覧の内容を CSV 形式で出力できる。
- **月次保険料一覧のCSV出力**：
  - 対象年月、氏名、年齢、標準報酬月額、健康保険・介護保険・厚生年金の本人負担・会社負担・合計額を出力。
  - 健康保険・介護保険、厚生年金、総合計それぞれのサマリー（納入告知額、従業員負担計、会社負担計）を自動計算して出力。
- **従業員台帳のCSV出力**：
  - 従業員の基本情報、就労条件、社会保険関連情報、口座情報、給与情報を出力。
  - 現在有効な標準報酬履歴（健康保険等級・標準報酬月額、厚生年金等級・標準報酬月額）も参照用として出力。
- **賞与一覧のCSV出力**：
  - 支給日、従業員情報、賞与支給額、標準賞与額、年度内累計、健康保険・介護保険・厚生年金の本人負担・会社負担・合計額を出力。
- 人事部門は出力したデータを給与システムや社内資料に再利用でき、手入力・転記の手間を削減できる。


### (16) 従業員情報の最終更新者・更新日時表示機能 ✅

- 従業員情報の更新時に、`updatedAt`（更新日時）と`updatedByUserId`（更新者ユーザーID）を自動的に記録する。
- 従業員一覧画面では、各従業員の更新日時と更新者名（ユーザーIDから表示名に変換）を表示する。
- 従業員詳細画面では、更新日時と更新者ユーザーIDを表示する。
- いつ・誰が変更したかを確認できることで、台帳管理の信頼性を高める。


### (17) 社会保険用語・ルールヘルプ機能 ✅

- 標準報酬月額・等級・賞与の範囲・短時間労働者の適用条件など、社会保険の基本用語やルールを画面上のヘルプアイコンから参照できる。
- 月次保険料ページと賞与保険料ページにヘルプアイコンを配置し、クリックでヘルプダイアログを表示する。
- 提供されているヘルプトピック：
  - **標準報酬月額・等級とは？**：標準報酬月額の定義、等級の決定方法（定時決定・随時改定）、等級の適用期間について説明。
  - **賞与として扱うべき範囲**：社会保険上の「標準賞与額」の対象となる支給の例と、含めない支給の例を説明。
  - **短時間労働者の社会保険適用条件**：短時間労働者が社会保険の適用対象になる条件（週20時間以上、月額8.8万円以上 等）を説明。
- 各トピックには注意事項も含まれており、最終的な判断は協会けんぽ・年金事務所・社労士等の案内に従うことを明記している。
- 人事担当者や新任担当者が制度を確認しながら操作できるようにし、誤操作や制度理解のミスを防ぐ。


### (18) 従業員情報の変更申請・承認（簡易ワークフロー）機能 ✅

- 一般従業員は、自分のプロフィール項目（住所・郵便番号・電話番号・連絡先メールアドレス・フリガナ）について、変更内容を「変更申請」として登録できる。
- 管理者・担当者（admin / hr）は、変更申請一覧ページで、申請内容（現在値／申請値・申請日時・申請者・申請種別）を確認し、承認・却下を行える。
- 承認された申請は、自動的に従業員台帳へ反映され、最終更新者・最終更新日時も更新される。
- 却下された申請は台帳には反映されず、却下理由を申請者が確認できる。
- 申請は「承認待ち」「承認済み」「却下済み」「取り下げ」のステータスで管理され、申請履歴として追跡できる。
- 賃金（報酬月額）・標準報酬月額・等級・社会保険加入フラグ・入社日・退職日など、社会保険料の計算に直接影響する項目は申請対象外とし、従来どおり admin / hr のみが直接編集する。
- 本機能は(24)従業員セルフ入力・手続き申請フロー機能の一部として実装されており、プロフィール変更申請の承認・却下を担当する。


### (19) 社会保険手続き状況・期限管理機能 ✅

- 従業員および被扶養者ごとに、健康保険・厚生年金に関する主要な社会保険手続きの「状況」と「履歴」を登録・閲覧できる。
  - 手続き種別（資格取得届／資格喪失届／算定基礎届／月額変更届／被扶養者異動届／賞与支払届）
    - InsurePath の手続き管理は、保険料算定に直結する主要 6 種類のみを対象とする。
  - 事由発生日（入社日・退職日・標準報酬決定の基準日・賞与支払日・被扶養者の異動日など）
  - 法定提出期限の目安
    - 事由発生日と手続き種別から、自動計算された「提出期限の目安」を保持する。
    - 計算は代表的なルールに基づく簡略ロジックとし、ユーザーが手動で修正できる。
      - 資格取得・資格喪失・被扶養者異動・賞与支払は「事由日＋5日」
      - 算定基礎届は「対象年の 7 月 10 日」
      - 月額変更届は「事由月の翌月 10 日」
    - ※最終的な提出要否・期限判断は事業所側の責任とし、実務上は各健保組合・年金事務所の案内に従う。
  - 手続きステータス（未着手／準備中／提出済／差戻し）
  - 実際の提出日・担当者名・備考メモ
- 事業所ごとに、手続き一覧画面で手続きの状況を管理できる。
  - ステータス（未着手／準備中／提出済／差戻し）、期限の状態（今週提出期限／来週提出期限／7日以内の期限／期限切れ）、手続き種別でフィルタし、表形式で絞り込み・確認できる。
  - 期限切れの手続きは赤色で強調表示され、ステータスごとにバッジ表示される。
  - これにより、資格取得届や賞与支払届などの届出漏れ・提出遅れのリスクを低減する。
- 【将来拡張案】入社・退職・標準報酬決定・賞与支給・被扶養者の追加／削除といったイベントが登録された際に、対応する手続きレコードの「作成候補」を自動生成し、人事担当者が内容を確認・確定できる仕組みを検討している。現状は人事担当者が必要に応じて手動登録する運用とする。
- 【将来拡張案】簡易カレンダー形式での可視化は将来の拡張案とする。


### (20) 被扶養者状況確認・年次見直し支援機能 ✅

- (4) 被扶養者（家族）管理機能と連携し、被扶養者の年次見直しや「被扶養者状況リスト」への回答作業を支援する。
- 事業所ごとに、「確認実施記録」を作成・管理できる。確認実施記録には以下を記録：
  - 基準年月日（例：2025年4月1日現在）
  - 実施日（確認作業を行った日）
  - 担当者名
  - 備考（確認実施に関するメモ）
- 特定の基準年月日時点で扶養に入っている被扶養者の一覧を抽出・表示できる。抽出条件は：
  - 資格取得日が基準年月日以前
  - 資格喪失日が基準年月日より後、または未設定
- 抽出された被扶養者ごとに、扶養状況確認結果を記録できる：
  - 確認日
  - 確認結果（継続／削除予定／要確認）
  - 確認担当者
  - 備考（所得状況・就労状況のメモなど）
- 確認結果は確認実施記録に紐づけて管理でき、特定の確認実施記録に紐づく確認結果のみをフィルタ表示できる。
- 抽出テーブル上で確認区分（継続／削除予定／要確認）をインライン操作で素早く変更できる。
- 確認結果一覧では、確認実施記録や確認結果（継続／削除予定／要確認）でフィルタして表示できる。
- 被扶養者資格の最終的な認定（継続・喪失）はあくまで事業所および健康保険組合等の判断とし、本システムは確認結果の記録・参照を支援する役割にとどめる。


### (21) 社会保険料納付状況管理機能 ✅

- 事業所ごと・対象年月ごとに、健康保険・介護保険・厚生年金の会社負担分について、
  「納付予定額」「納付額（実際に納付した金額）」「納付日」「納付方法」「納付ステータス（未納／納付済／一部納付／納付不要）」を記録できる。
- 納付予定額は、人事・総務担当者が手動で入力する。月次保険料ページと賞与保険料ページのサマリー（健康・介護保険の会社負担額と厚生年金の会社負担額）を参照し、それぞれの合計値を入力欄に入力する。
- 納付予定額は健康・介護保険（会社負担）と厚生年金（会社負担）を分けて入力し、システムが自動的に合計を計算する。
- 納付完了後に、納付日およびその月の納付額（会社負担分）を登録することで、その月の納付ステータスを更新できる。
- 「納付済」ステータスを選択した場合は、納付日と納付額（会社負担）の入力が必須となる。
- ダッシュボード上で、「今月納付予定の社会保険料（会社負担分）」をカード形式で表示し、クリックで納付状況管理ページへ遷移できる。
- ダッシュボード上で、「最近の納付状況（最大12件）」を一覧表示し、各月の納付ステータス（未納／納付済／一部納付／納付不要）を把握できる。これにより、社会保険料の納付漏れや金額確認漏れを防止する。
- 実際の金融機関への振込処理や会計仕訳の起票は対象外とし、本システムは社会保険料納付状況の記録・確認を支援する役割に限定する。


### (22) e-Gov届出対応マスタ管理機能 ✅

- InsurePath 上で扱う「資格取得・資格喪失・算定基礎・月額変更・被扶養者異動・賞与支払」などの社会保険手続きに必要な事業所・従業員・被扶養者の主要項目を、一元的に管理できる。
- 事業所については、事業所記号・事業所番号・郡市区符号・事業主氏名・所在地（住所／郵便番号／電話番号）など、届出様式で利用される識別情報を登録・更新できる。
- 従業員については、氏名（漢字／カナ）、生年月日、性別、住所・郵便番号、被保険者整理番号、基礎年金番号、標準報酬月額、月額報酬、入社日など、資格取得・喪失や算定基礎・月額変更で必要となる基本情報を管理できる。
- 被扶養者については、氏名（漢字／カナ）、生年月日、性別、住所・郵便番号、同居／別居区分、マイナンバーなど、被扶養者（異動）届で利用する主要情報を整理して保持できる。
- 担当者は InsurePath のマスタ画面を参照しながら e-Gov の入力画面へ転記することで、紙やExcelに分散しがちな情報を一箇所で把握しつつ、届出作成作業を効率化できる。
- 本システムは e-Gov への直接送信や CSV 出力は行わず、「e-Gov届出に必要な基礎情報を漏れなく整備しておけるマスタ管理機能」として位置づける。
  - なお、項目設計にあたっては、日本年金機構が公開している届書作成仕様書（資格取得・喪失・算定基礎・月額変更・賞与支払・被扶養者異動に関する仕様）を参考にしている。


### (23) 公的帳票（届出書）入力補助情報 PDF 出力機能 ✅

- 資格取得届・資格喪失届・賞与支払届の3種類の届出書について、従業員データから必要項目を自動反映した入力補助用PDFを生成できる。
- 生成されるPDFは入力補助用の参考様式であり、届け出作成時の補助資料として利用する。
- PDFは以下の3つのアクションが可能：
  - プレビュー（ブラウザで開く）
  - ダウンロード（PDFファイルとして保存）
  - 印刷（直接印刷）
- 1名分ずつの個別帳票だけでなく、複数名分をまとめた一覧形式（簡略様式）も出力できる：
  - 資格取得届・資格喪失届：複数従業員を選択してバッチ生成可能（1つのPDFに複数名分をまとめて出力）
  - 賞与支払届：月次まとめ形式で、対象年月の賞与支払データを複数名分まとめて出力
- データ不足項目の検証機能を提供し、不足している項目を警告表示する（致命的項目・主要項目・任意項目に分類）。
- 生成した帳票の履歴保持機能は現時点では未実装（将来拡張として検討中）。


### (24) 従業員セルフ入力・手続き申請フロー機能 ✅

- 既存の従業員本人がマイページから、自分および家族の情報を入力・更新できるセルフ入力フォームを提供する。
- 申請種別として以下が利用可能：
  - プロフィール変更（住所・郵便番号・電話番号・連絡先メールアドレス・フリガナ）※(18)と連携
  - 口座情報の変更・登録（給与振込口座情報：金融機関名・支店名・口座種別・口座番号・名義など）
  - 扶養家族の追加・変更・削除（被扶養者情報：氏名・フリガナ・続柄・生年月日・性別・住所・同居別居区分など）
- 従業員の入力内容は「変更申請」として一時保存され、管理者・担当者（admin / hr）が変更申請一覧ページで内容を確認・承認・却下したタイミングで従業員台帳・被扶養者情報に反映される。
- 申請は「承認待ち」「承認済み」「却下済み」「取り下げ」のステータスで管理され、申請履歴として追跡できる。
- 従業員はマイページから自分の申請履歴を確認でき、承認待ちの申請は取り下げ可能。
- セルフ入力により、人事・総務担当者の手入力負担を軽減しつつ、申請内容と反映結果の経緯を履歴として追跡できる。
- プロフィール変更申請の承認・却下は(18)従業員情報の変更申請・承認（簡易ワークフロー）機能で処理される。
- 注：入社時の新規従業員登録は管理者（admin / hr）が従業員台帳から行い、入社時のセルフ入力フォームは提供していない。


### (25) 社会保険関連添付書類管理機能（ドキュメントセンター） ✅

- 健康保険・介護保険・厚生年金に関する各種添付書類（本人確認書類、収入証明、在学証明、続柄・同居証明、他制度加入証明、障害・介護関連証明 等）を、従業員ごとの「書類ボックス」に紐づけて一元管理できる。
- 書類ごとに「書類種別（本人確認／収入証明 等）」「任意タイトル」「有効期限」「アップロード日」「アップロード者」「対象従業員」などのメタ情報を保持し、どの従業員のどの書類がいつ提出されたかを即座に確認できる。
- 管理者（admin / hr）は書類管理ページ（ドキュメントセンター）から、従業員単位で書類の登録・閲覧・ダウンロード・削除を行えるほか、「○○の書類を提出してください」といったアップロード依頼を送信できる。従業員はマイページから自分宛ての依頼一覧を確認、指定された書類をアップロード可能。
- 添付書類の閲覧権限はロール（admin / hr / employee）および事業所単位に応じて制御し、一般従業員は自分自身に関する書類のみ閲覧できるなど、必要最小限の公開範囲とする。
- 書類ボックスでは、「有効期限が近い書類（30日以内）」「有効期限切れの書類」「アップロード依頼済みだが未提出の書類」などを絞り込んで一覧表示できるようにし、更新漏れ・提出漏れを防止する。


### (26) 保険料率・等級表クラウドマスタ・自動更新機能　✅

- 協会けんぽおよび厚生年金・介護保険などの全国共通マスタについて、システム全体で共有する「クラウドマスタ」として保険料率・等級表を一元管理できるようにする。
  - システム開発者がクラウドマスタ管理ページから適用開始年月別・都道府県別（健康保険の場合）にマスタを登録・更新すると、各事業所のマスタ作成時に「料率読み込み」ボタンからクラウドマスタを初期値（テンプレート値）として読み込める（事業所側での個別更新作業を最小化する）。
  - 健康保険マスタは協会けんぽのみを対象とし、都道府県別に管理する。介護保険・厚生年金マスタは全国共通として管理する。
  - 組合健保など事業所ごとに異なるマスタが必要な場合は、クラウドマスタを初期値として読み込んだ後、事業所単位で上書き・調整できる構造とする。
  - 事業所管理者はクラウドマスタを利用せず、手動で直接マスタを設定することも可能。
  - マスタの更新日時・更新者IDを保持し、「どの時点で誰が更新したか」を追跡できる。旧料率／新料率の詳細な履歴管理は将来拡張として検討中。
  - クラウドマスタ自体の更新はシステム開発者がクラウドマスタ管理ページ（隠しページ）から手動で行い、協会けんぽ等の外部サイトからの自動取得は行わない（(6) の方針を踏襲）。


### (27) マイナンバー管理機能 ✅

- 拡張機能として、従業員および被扶養者のマイナンバー（個人番号）を管理できる。
- マイナンバーは12桁の数字として保存され、MyNumberServiceを通じて暗号化・復号の仕組みを提供（現時点では実装はプレースホルダーとして、将来の本格的な暗号化実装に備えた設計）。
- 画面表示時には、原則として下4桁のみのマスキング表示（例：`*******1234`）とし、フル番号の入力・編集は管理者（admin / hr）のみが可能。
- 従業員詳細画面では「登録済み（番号は非表示）」または「未登録」として表示され、フル番号は表示されない。
- マイページでは、従業員本人のマイナンバーがマスキング表示される。
- アクセスログ（閲覧者・日時・目的）の記録機能は将来拡張として検討中。


### (28) 多言語対応機能 🔼不採用

- 日本語に加え、英語 UI への切り替えに対応し、日本語が母語でない従業員・担当者も利用しやすい画面を提供する。
- ログインユーザーごとに「表示言語」を設定できるようにし、多言語化する。
- 社会保険固有の用語については、ツールチップやヘルプと連携し、多言語でも誤解が生じにくい説明文を併記する。
- 将来的には、英語以外の言語（例：ベトナム語・中国語 等）への拡張も可能な構成とし、グローバル人材を多く抱える事業所での利用も想定する。


### (29) 社会保険情報の異常値チェック・ギャップ検知機能 ✅

- 従業員台帳・資格情報・標準報酬履歴などのデータに対して、代表的な「おかしな状態」を自動チェックする。
- 実装済みのチェックルール（9ルール）：
  - **ルール1**: 資格・加入フラグ不整合（isInsured = true なのに資格取得日や標準報酬履歴が未登録、または資格取得日があるのに isInsured = false。入社日から1ヶ月以内の猶予期間あり）
  - **ルール2**: 退職日と資格喪失日の不整合（退職日が入力されているのに、資格取得日があるにもかかわらず資格喪失日が未設定）
  - **ルール3**: 資格取得日より前の適用開始年月の履歴（標準報酬履歴の適用開始年月が資格取得日より前になっている）
  - **ルール4**: 資格喪失日が資格取得日より前（資格喪失日が資格取得日より前になっている）
  - **ルール5**: 退職日が入社日より前（退職日が入社日より前になっている）
  - **ルール6**: 資格喪失日より後の標準報酬履歴（標準報酬履歴の適用開始年月が資格喪失日より後になっている）
  - **ルール7**: 標準報酬履歴の適用開始年月が未来（適用開始年月が現在より未来になっている）
  - **ルール8**: 資格取得日が入社日より前（資格取得日が入社日より前になっている。転籍などの例外ケースを除き、確認が必要）
  - **ルール9**: 資格取得日が未来（資格取得日が現在より未来になっている）
- 検知された異常・要確認レコードは「異常値チェック結果」画面（`/data-quality`）に一覧表示し、人事・総務担当者が内容を確認・修正できる。issueTypeは日本語ラベルで表示される。
- 各ルールの説明をアコーディオン形式の説明カードで表示し、ユーザーが各ルールの内容を理解しやすいようにしている。
- 確認済み機能を実装：
  - 警告を「確認済み」としてマーク可能（Firestoreの`dataQualityAcknowledgedIssues`コレクションに保存）
  - 確認済みを「解除」して未確認に戻すことが可能
  - 警告が解消されると、対応する確認済みマークも自動的に削除される（stale削除）
  - 同じ条件で再度警告が発生した場合は、未確認として表示される（確認済みが復活しない）
  - 操作後のリアルタイム反映により、リロード不要でUIが更新される
- 異常の種類ごとに件数を集計し、ダッシュボード上で「要確認データ：◯件」としてサマリ表示し、カードクリックで`/data-quality`へ遷移できる。確認済みの警告は件数に含めない（未確認のもののみカウント）。
- `DataQualityIssue`はFirestoreに保存せず、画面表示時に毎回計算して表示する方式。確認済みマークのみFirestoreに保存される。


### (30) 手続きタスクの期限別ビュー・簡易アラート機能 ✅

- (19) 社会保険手続き状況・期限管理機能と連携し、「いつまでに何の手続きを行う必要があるか」をタスク一覧として見える化する。
- 手続き一覧画面で、手続き種別・対象者（従業員名／被扶養者名）・事由発生日・提出期限・ステータス・提出日・担当者名をまとめて確認できる。
- 期限別ビューで未完了の手続きを絞り込み：  
  - 「今週提出期限」（今週の月曜日から日曜日までの期間に提出期限がある手続き）
  - 「来週提出期限」（来週の月曜日から日曜日までの期間に提出期限がある手続き）
  - 「期限が近い（7日以内）」（今日から7日以内に提出期限がある手続き）
  - 「期限切れ」（提出期限を過ぎて未完了の手続き）
- ダッシュボードに「今週提出期限の手続き：◯件」「期限超過の手続き：◯件」をカード形式で表示し、カードクリックで手続き一覧画面の該当フィルタビューへ遷移できる。
- 期限切れ行の強調表示（赤色）やステータス別バッジ表示（未着手：青、準備中：水色、提出済：緑、差戻し：赤）により、重要な手続きを見落としにくくする。
- 外部通知・プッシュ通知は範囲外とする。


### (31) 外部給与システム連携（CSV）機能 🔼不採用

**不採用理由**: (14) 従業員情報一括インポート機能・(15) 保険料データのCSVエクスポート機能と大部分が被っており、必要でないと判断。

- 本システムは給与計算そのもの（所得税・住民税・手取り額の算出や給与明細の発行）を対象外としつつ、既存の給与システムと連携しやすい構成とすることで、社会保険料計算結果を給与計算へスムーズに反映できるようにする。
- 外部給与システムとの連携は、まずは CSV ファイルによる連携を前提とする。
  - (14) 従業員情報一括インポート機能により、外部システムで管理している従業員情報（氏名・生年月日・雇用区分・報酬月額・入社日 等）を CSV 形式で読み込み、InsurePath の従業員台帳を初期登録・更新できる。
  - (15) 保険料データの CSV エクスポート機能により、月次保険料一覧や賞与にかかる社会保険料（本人負担・会社負担）の集計結果を給与システムで取り込みやすい形式の CSV として出力できる。
- 代表的なクラウド人事・給与システムが出力する従業員情報 CSV の項目構成を参考に、InsurePath 側で「インポート用テンプレート」を用意し、列名や形式のマッピングを行いやすくする。これにより、既存の給与システムで管理している従業員・給与データを、社会保険管理用の台帳に再入力する手間を軽減する。


### (32) 口座情報・給与情報管理機能 ✅

- 従業員ごとに、給与振込口座情報（金融機関名・支店名・口座種別・口座番号・名義）を台帳として登録・管理できる。
- 給与に関する基本情報（支給形態：月給・日給 等、支給サイクル、報酬月額）を併せて保持し、社会保険料計算の前提条件として保持しておく。
- 口座情報・給与情報はあくまで「台帳情報」として管理し、所得税・住民税・手取り額の算出や給与明細発行などの給与計算そのものは対象外とする。
- 権限（admin / hr）に応じて参照・編集可能範囲を制御し、一般従業員は自分自身の口座情報・給与情報のみを確認できる。

### (33) CSVテンプレートダウンロード機能 ✅

- 従業員CSVインポート用に、ヘッダ行のみを含むテンプレートCSVをダウンロードできる。
- テンプレートには詳細なコメント行が含まれており、以下の情報が記載されている：
  - 新規作成と更新の違い（ID列の扱い）
  - セルの入力ルール（空欄・値あり・`__CLEAR__`の意味）
  - ネストオブジェクト（口座情報・給与情報）の削除方法
  - 必須項目の一覧
  - 選択肢の入力値（雇用形態、性別、資格取得区分、資格喪失理由、就業状態、支給形態、支給サイクル、口座種別）
  - データ形式（日付、年月、数値、真偽値、保険料免除月の形式）
  - 標準報酬関連の注意事項
- CSVインポートの初回利用時に項目数がずれたり記入漏れによってエラーが起きることを可能な限り防ぐ。
- テンプレートは従業員インポートダイアログと従業員一覧ページの両方からダウンロード可能。


---

## 制約条件

- 対象とするのは日本国内の 健康保険・介護保険・厚生年金保険 であり、協会けんぽおよび厚生年金の標準報酬月額表・保険料率を簡略化した形で扱う。実務上のすべての等級・ケースを網羅するものではない。
- 被保険者資格および被扶養者資格の取得・喪失に関する細かな実務ルール（届出期限・事後修正の扱い等）は簡略化し、本システムは資格日や基本属性の管理・閲覧を支援するに留め、最終的な資格認定や届出内容の確定は事業所および関係機関の判断に委ねる。
- 保険料率および標準報酬月額の変更（法改正）について、外部サイトからの自動取得は行わず、システム開発者がクラウドで初期値を登録・変更することはできるが各事業所の最終的な年度別の料率・等級表は各管理者が手動で更新する運用とする。
- 入社月・退職月・同月内転職などの扱いは、実務上のルールを参考にしつつ簡略化したロジックで実装し、特殊な例外ケースには対応しない。必要に応じて最終的な金額は公的資料で確認することを前提とする。
- 退職後の任意継続被保険者は本システムの管理対象外とし、在籍中の被保険者（健康保険・介護保険・厚生年金の被保険者）のみを対象とする。
- 短時間労働者（パート・アルバイト等）の社会保険適用について、実務上は一般に次のような条件（例：週の所定労働時間 20 時間以上、月額賃金 8.8 万円以上、雇用期間 2 か月超の見込み、学生でないこと、一定規模以上の事業所 等）をもとに判断されるが、これらの最終判断は事業所側の責任とし、本システムは事業所が「社会保険加入対象」と判断した従業員のみを isInsured フラグを通じて管理・計算する。
- ユーザーは必ず1つの事業所に所属する前提とし、「所属事業所 ID」に基づいてデータをスコープする。ログインユーザーは、自分が所属する事業所のデータのみ閲覧・操作できる。
- ユーザーアカウントは、同時に1つの事業所にのみ所属できる。（「転職などで会社が変わればメールも変わる」前提で設計）
- 一度事業所を作成したアカウントは、他の事業所に所属変更することはできない（別の事業所に参加する場合は、新しいアカウントを作成する）。
- 従業員情報の変更申請・承認ワークフローは、住所・連絡先などのプロフィール項目を対象とした 1 段階承認の簡易機能に限定する。賃金（報酬月額）・標準報酬月額・等級・社会保険加入フラグ・入社日・退職日など、社会保険計算に直接影響する項目は申請の対象外とし、引き続き管理者・担当者が画面から直接更新する。多段階承認や柔軟なフロー定義などの高度なワークフロー機能は対象外とする。
- 給与計算そのもの（所得税・住民税・手取り額計算など）は対象外とする。
- 利用環境は Web ブラウザ（最新の Google Chrome / Microsoft Edge）を前提とする。
- オンライン接続を前提とし、オフライン状態での編集・保存は想定しない。
- 1 つの事業所あたり数百名規模の従業員を想定して設計する。
- 通貨を前提にしており、現物と通貨を区別するような機能はない。
